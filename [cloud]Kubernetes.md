## 쿠버네티스 아키텍쳐

### 컨테이너

디스크의 파일 변경 사항을 레이어 형태로 저장하는 파일 시스템을 합한 컨테이너라는 개념.

### 컨테이너 오케스트레이션

이것을 이용하면 수동 제어 부분 모두를 자동화하므로 시스템 운영에 용이하다. 컨테이너 오케스트레이션 시스템으로 상용 서비스에 사용할 서버들을 클러스터로 구성하면, 서버 1대든 100대든 컨테이너를 한 번의 명령으로 자동 배포할 수 있다. 사용 중인 클러스터 일부에 장애가 발생하면 오케스트레이션 시스템은 알아서 장애가 발생한 서버에 있는 컨테이너들을 정상 운영 중인 다른 서버로 옮겨서 실행시킨다. 장애가 발생한 서버로 향하는 트래픽도 자동으로 중지시키고 새로 옮긴 컨테이너로 보낸다. 개발자는 장애가 잘생하면 오케스트레이터에게 맡겨두고 장애를 수정하면된다.
(클러스터: 여러 대의 서버를 묶어 시스템 하나로 구성하는 방식)

### 쿠버네티스 클러스터 전체 구조

쿠버네티스 클러스터는 크게 두 종류의 서버로 구성됨. 이 둘이 어떤 구조로 통신하는지 알면 됨.
- Master: 클러스터를 관리. 아래 컴포넌트들이 실행됨. 고가용성을 위해 서버 3대 정도로 구성됨. 하나는 리더 마스터 1대 나머지는           대기하고 있다가 장애 생기면 대체함. 
  마스터용 컴포넌트
    etcd
    kube-apiserver
    kube-scheduler
    kube-controller-manager
    kubelet
    kube-proxy
    docker
- Node: 실제 컨테이너를 실행. 아래 컴포넌트들이 실행됨. minion이라고도 부름. 실행 환경을 관리함.
  kubelet: 클러스터 안 모든 노드에서 실행되는 에이전트. 파드 컨테이너들의 실행을 직접 관리한다. podspecs파드스펙 조건을 받아서 컨테이너를 실행하고 컨테이너가 정상적으로 실행되는지 헬스 체크를 한다. 단 노드 안에 있는 컨테이너라도 쿠버네티스가 만들지 않은 컨테이너는 관리하지 않는다.
  kube-proxy
  docker
  
  
쿠버네티스는 크게 오브젝트와 오브젝트를 관리하는 컨트롤러로 나눈다.
  



## Pod
쿠버네티스에서 컨테이너를 관리하는 기본 단위. 파드로 컨테이너 여러 개를 한꺼번에 관리할 때는 컨테이너마다 역할을 부여할 수 있다. 파드 하나에 속한 컨테이너들은 모두 노드 하나 안에서 실행된다.(여러 노드에 흩어져서 실행되는 일은 없다.) 파드의 역할 중 하나가 컨테이너들이 같은 목적으로 자원을 공유하는 것이므로 가능한 일이다.
파드의 생명주기
컨테이너 상태 확인 방법
초기화 및 파드 인프라 컨테이너
스태틱 파드

## 컨트롤러
파드들을 관리하는 역할
레플리케이션 컨트롤러
deployment
demon


## 서비스
여러 개 파드에 접근할 수 있는 IP하나를 제공한다. 다양한 기능을 제공하지만 본질적으로 로드밸런서 역할이라고 생각하면 된다. 
kube-proxy



## 인그레스
주로 클러스터 외부에서 안에 있는 파드에 접근할 때 사용하는 방법


## 레이블과 애너테이션
자원들의 메타데이터를 관리하는 데 사용한다.
레이블은 셀렉터와 함께 특정 레이블이 있는 자원들을 선택할 때 주로 사용한다.


